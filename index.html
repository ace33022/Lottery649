<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> -->

<!DOCTYPE html>
<html lang="zh-Hant-TW">

  <head>

		<!-- <base href="W:/Tool/Package/LangEnv/Java/apache-tomcat/webapps/ROOT/"> -->
		
		<base href="/">

    <meta http-equiv="Content-Language" content="zh-tw">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

    <meta name="theme-color" content="#ffffff">

    <meta name="author" content="ace33022">
		<meta name="robots" content="index,follow">
		<meta name="force-login" content="N">

    <meta name="keywords" content="Lottery649">
    <meta name="description" content="Lottery649">

    <title>Lottery649</title>
		
		<!--
		<link type="image/png" rel="icon" href="images/favicon.png" />
		
		<link type="text/css" rel="stylesheet" href="javascripts/tablesort/tablesort.css" media="print, projection, screen" />

    <link type="text/css" rel="stylesheet" href="javascripts/jquery/jquery-ui/themes/base/jquery.ui.base.css" />
    <link type="text/css" rel="stylesheet" href="javascripts/jquery/jquery-ui/themes/base/jquery.ui.theme.css" />

    <link type="text/css" rel="stylesheet" href="javascripts/bootstrap/bootstrap/dist/css/bootstrap.css" />
		<link type="text/css" rel="stylesheet" href="javascripts/bootstrap/bootstrap/dist/css/bootstrap-theme.css" />
    <link type="text/css" rel="stylesheet" href="javascripts/bootstrap/jasny-bootstrap/dist/css/jasny-bootstrap.css" />
    <link type="text/css" rel="stylesheet" href="javascripts/bootstrap/bootstrap-fileinput/css/fileinput.css" media="all" />

    <link type="text/css" rel="stylesheet" href="stylesheets/Font-Awesome/css/font-awesome.css" />
		  -->

		<link type="image/png" rel="icon" href="https://bold33022.github.io/r-life/images/favicon.png" />
		
		<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" />
    <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap-theme.min.css" />

		<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jasny-bootstrap/3.1.3/css/jasny-bootstrap.min.css" />
		<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/4.3.8/css/fileinput.min.css" media="all" />
		
		<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
		
		<!-- <link type="text/css" rel="stylesheet" href="https://tristen.github.io/tablesort/tablesort.css" media="print, projection, screen" /> -->
		<link type="text/css" rel="stylesheet" href="https://sites.google.com/site/ace33022/css/tablesort.css" media="print, projection, screen" />

    <style type="text/css">

			html, body {

				height: 100%;
				margin: 0;
				padding: 0;
			}
		</style>

		<!--
    <script type="text/javascript" src="javascripts/tw/ace33022/NameSpace.js"></script>

    <script type="text/javascript" src="javascripts/tw/ace33022/DefaultConfigurations.js"></script>
		<script type="text/javascript" src="javascripts/Configurations.js"></script>

		<script type="text/javascript" src="javascripts/tw/ace33022/RequireJSConfig.js"></script>

		<script type="text/javascript" src="javascripts/requirejs/require.js"></script>
		  -->

		<script type="text/javascript" src="https://ace33022.github.io/tw/ace33022/NameSpace.js"></script>

    <script type="text/javascript" src="https://ace33022.github.io/tw/ace33022/DefaultConfigurations.js"></script>
    <script type="text/javascript" src="https://ace33022.github.io/tw/Configurations.js"></script>

    <script type="text/javascript" src="https://ace33022.github.io/tw/ace33022/RequireJSConfig.js"></script>

		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.js"></script>
		
    <script type="text/javascript">

			requirejs.config(tw.ace33022.RequireJSConfig);
    </script>
  </head>

  <!--
    --
    -- Lottery649
    --
    -- @version 2017/03/03 初始版本。
    --
    -- @description
    --
    -- @author ace
    --
    -- @see <a href="https://developer.mozilla.org/en-US/docs/Web">Web technology for developers | MDN</a>
    -- @see <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript">JavaScript | MDN</a>
    --
		-- @see <a href="https://github.com/tristen/tablesort">tristen/tablesort: A small tablesorter in plain JavaScript</a>
    --
    -- @see <a href="https://jquery.com/">jQuery</a>
		-- @see <a href="https://api.jquery.com/attribute-equals-selector/">Attribute Equals Selector [name=”value”] | jQuery API Documentation</a>
		-- @see <a href="https://api.jquery.com/multiple-attribute-selector/">Multiple Attribute Selector [name=”value”][name2=”value2″] | jQuery API Documentation</a>
		--
		-- @see <a href="https://getbootstrap.com/">Bootstrap · The world's most popular mobile-first and responsive front-end framework.</a>
		-- @see <a href="http://bootboxjs.com/">Bootbox.js — alert, confirm and flexible dialogs for the Bootstrap framework</a>
		-- @see <a href="http://plugins.krajee.com/file-input">Bootstrap File Input - © Kartik</a>
		--
		-- @see <a href="http://underscorejs.org/">Underscore.js</a>
		-- @see <a href="https://github.com/jashkenas/underscore">jashkenas/underscore: JavaScript's utility _ belt</a>
		--
		-- @see <a href="http://backbonejs.org/">Backbone.js</a>
		-- @see <a href="https://github.com/jashkenas/backbone/">jashkenas/backbone: Give your JS App some Backbone with Models, Views, Collections, and Events</a>
		--
		-- @see <a href="https://www.highcharts.com/">Interactive JavaScript charts for your webpage | Highcharts</a>
		--
		-- @see <a href="https://learn.jquery.com/using-jquery-core/faq/how-do-i-disable-enable-a-form-element/">How do I disable/enable a form element? | jQuery Learning Center</a>
		-- @see <a href="http://zh-tw.learnlayout.com/display.html">CSS - 關於 "display" 屬性</a>
		-- @see <a href="http://stackoverflow.com/questions/4942070/differences-between-detach-hide-and-remove-jquery">javascript - Differences between detach(), hide() and remove() - jQuery - Stack Overflow</a>
		--
		-- @see <a href="https://stackoverflow.com/questions/18432394/how-to-make-twitter-bootstrap-modal-full-screen">css - How to make Twitter bootstrap modal full screen - Stack Overflow</a>
		-- @see <a href="https://stackoverflow.com/questions/35177128/radio-buttons-in-bootstrap-navigation-bar">css - Radio buttons in bootstrap navigation bar - Stack Overflow</a>
    --
    -- @comment
		--
		-- @todo
		--
    -->

  <body>

		<script type="text/javascript">

			requirejs(["tw.ace33022.util.browser.ReUtils", "tw.ace33022.util.browser.FormUtils", "underscore"], function(ReUtils, FormUtils) {
			
				jQuery(document).ready(function() {

					ReUtils.beforeInitEnv(function() {
					
						requirejs(["tw.ace33022.backbone.view.MSC00010", "tw.ace33022.util.StringUtils"], function(View, StringUtils) {
						
							var appId = 'appId' + Math.random().toString(36).substr(2, 6);

							var view;

							var btnLottery649NumPadId = 'btnLottery649NumPad' + Math.random().toString(36).substr(2, 6);
							var chart01Id = 'chart01' + Math.random().toString(36).substr(2, 6);
							var chart02Id = 'chart02' + Math.random().toString(36).substr(2, 6);
							var report01Id = 'report01' + Math.random().toString(36).substr(2, 6);
							var dataFilterId = 'dataFilter01' + Math.random().toString(36).substr(2, 6);

							jQuery('body').append('<div id="' + appId + '" class="container-fluid"></div>');

							view = new View({

								"el": '#' + appId,
								"buttonAddedTrigger": function() {

									if (this.getArrLottery649LogsVO().length == 0) {

										jQuery('#' + btnLottery649NumPadId).parent().addClass('disabled');
										jQuery('#' + chart01Id).parent().addClass('disabled');
										jQuery('#' + chart02Id).parent().addClass('disabled');
										jQuery('#' + report01Id).parent().addClass('disabled');
										jQuery('#' + dataFilterId).parent().addClass('disabled');
									}
									else {

										jQuery('#' + btnLottery649NumPadId).parent().removeClass('disabled');
										jQuery('#' + chart01Id).parent().removeClass('disabled');
										jQuery('#' + chart02Id).parent().removeClass('disabled');
										jQuery('#' + report01Id).parent().removeClass('disabled');
										jQuery('#' + dataFilterId).parent().removeClass('disabled');
									}
								},
								"dataChangeTrigger": function() {
							
									if (this.getArrLottery649LogsVO().length == 0) {

										jQuery('#' + btnLottery649NumPadId).parent().addClass('disabled');
										jQuery('#' + chart01Id).parent().addClass('disabled');
										jQuery('#' + chart02Id).parent().addClass('disabled');
										jQuery('#' + report01Id).parent().addClass('disabled');
										jQuery('#' + dataFilterId).parent().addClass('disabled');
									}
									else {

										jQuery('#' + btnLottery649NumPadId).parent().removeClass('disabled');
										jQuery('#' + chart01Id).parent().removeClass('disabled');
										jQuery('#' + chart02Id).parent().removeClass('disabled');
										jQuery('#' + report01Id).parent().removeClass('disabled');
										jQuery('#' + dataFilterId).parent().removeClass('disabled');
									}
								}
							});

							view.addDropdownMenu({

								"menuCaption": "載入資料",
								"items": [
									{
										"caption": "From File",
										"click": function(event) {

											jQuery('.collapse').collapse('hide');

											FormUtils.selectFileModal({

												"title": "選取檔案",
												"callback": function(file) {

													if (file != null) view.loadDataFromCSVFile(file);
												}
											});
										}
									},
									{
										"caption": "選取號碼",
										"id": btnLottery649NumPadId,
										"click": function(event) {

											jQuery('.collapse').collapse('hide');

											view.showLottery649NumberPad();
										}
									},
									{
										"caption": "排序/篩選",
										"id": dataFilterId,
										"click": function(event) {

											var tag;
										
											var modalHeader, modalBody, modalFooter;
											var baseModal;
											
											jQuery('.collapse').collapse('hide');

											tag = '<div class="modal-header">'
													+ '  <h4 style="text-align: center;">排序/篩選</h4>'
													+ '</div>';
											modalHeader = jQuery(tag);

											tag = '<div class="modal-footer">'
													+ '  <input type="button" class="btn btn-primary" data-dismiss="modal" value="關閉" />'
													+ '</div>';
											modalFooter = jQuery(tag);

											tag = '<div style="margin-top: 2px; margin-bottom: 2px;">'
													+ '  <span>獎號順序：</span>'
													+ '  <div class="btn-group">'
													+ '    <label class="btn" style="overflow: hidden; vertical-align: middle;"><input type="radio" style="position: absolute; vertical-align: middle; height: 1px; width: 1px; top: -20px;" name="sortType" value="prizeSort">獎號開出順序</label>'
													+ '    <label class="btn" style="overflow: hidden; vertical-align: middle;"><input type="radio" style="position: absolute; vertical-align: middle; height: 1px; width: 1px; top: -20px;" name="sortType" value="numberSort">獎號大小順序</label>'
													+ '  </div>'
													+ '</div>'
													+ '<div style="margin-top: 2px; margin-bottom: 2px;">'
													+ '  <span>獎號篩選：</span>'
													+ '  <div class="btn-group">'
													+ '    <label class="btn" style="overflow: hidden; vertical-align: middle;"><input type="radio" style="position: absolute; vertical-align: middle; height: 1px; width: 1px; top: -20px;" name="prize" value="all">ALL</label>'
													+ '    <label class="btn" style="overflow: hidden; vertical-align: middle;"><input type="radio" style="position: absolute; vertical-align: middle; height: 1px; width: 1px; top: -20px;" name="prize" value="prize01">只顯示頭獎開出資料</label>';
													+ '  </div>'
													+ '</div>';
											modalBody = jQuery(tag);
										
											modalBody.find('input').on('click', function(event) {
										
												jQuery(this).parent().siblings().removeClass('btn-primary');
												jQuery(this).parent().siblings().removeClass('btn-default');
											
												modalBody.find('input[name="' + jQuery(this).prop('name') + '"]').each(function(index, element) {
										
													if (jQuery(element).prop('checked') == true) {
											
														jQuery(element).parent().addClass('btn-primary');
													}
													else {
											
														jQuery(element).parent().addClass('btn-default');
													}
												});
											});
										
											baseModal = FormUtils.addBaseModal(modalHeader, modalBody, modalFooter);
										
											baseModal.on('shown.bs.modal', function(event) {
										
												var filterCondition = view.getFilterCondition();
										
												modalBody.find('input[name="prize"][value="' + filterCondition["prize"] + '"]').prop('checked', true);
												modalBody.find('input[name="sortType"][value="' + filterCondition["sortType"] + '"]').prop('checked', true);

												modalBody.find('input[name="prize"][value="' + filterCondition["prize"] + '"]').trigger('click');
												modalBody.find('input[name="sortType"][value="' + filterCondition["sortType"] + '"]').trigger('click');
											});
										
											baseModal.on('hidden.bs.modal', function(event) {
										
												var filterCondition = {
											
													"prize": baseModal.find('input[name="prize"]:checked').val(),
													"sortType": baseModal.find('input[name="sortType"]:checked').val()
												};
											
												jQuery(this).remove();
											
												view.setFilterCondition(filterCondition);
											});
			
											baseModal.modal('show');
										}
									}
								]
							});

							view.addDropdownMenu({

								"menuCaption": "Chart",
								"items": [
									{
										"caption": "獎號統計圖",
										"id": chart01Id,
										"click": function(event) {
									
											// Display Chart Column

											jQuery('.collapse').collapse('hide');
										
											view.showChart01();
										}
									},
									{
										"caption": "獎號總和線形圖",
										"id": chart02Id,
										"click": function(event) {
									
											// Display Chart Column
										
											jQuery('.collapse').collapse('hide');
										
											view.showChart02();
										}	
									}
								]
							});

							view.addDropdownMenu({

								"menuCaption": "Report",
								"items": [
									{
										"caption": "獎號近期資訊",
										"id": report01Id,
										"click": function(event) {

											jQuery('.collapse').collapse('hide');

											requirejs(["moment", "sprintfjs"], function(moment) {

												function findLastAppeared(num) {

													var result = null;

													var index = view.getArrLottery649LogsVO().length - 1;
													var vo;

													for (; index >= 0; index--) {

														vo = view.getArrLottery649LogsVO()[index];

														if (((vo.getNum01() === num) || (vo.getNum02() === num) || (vo.getNum03() === num) || (vo.getNum04() === num) || (vo.getNum05() === num) || (vo.getNum06() === num)) === true) {

															result = vo;
															break;
														}
													}

													return result;
												}

												var index;
												var vo;

												var tag;
												var trElement;

												var modalHeader, modalBody, modalFooter;
												var baseModal;

												tag = '<div class="modal-header">'
														+ '  <h4 style="text-align: center;">獎號近期資訊</h4>'
														+ '</div>';
												modalHeader = jQuery(tag);

												tag = '<div class="modal-footer">'
														+ '  <input type="button" class="btn btn-primary" data-dismiss="modal" value="關閉" />'
														+ '</div>';
												modalFooter = jQuery(tag);

												tag = '<table class="table table-hover table-bordered">'
														+ '  <thead>'
														+ '    <tr>'
														+ '      <th style="text-align: center; background-color: #A9A9A9; cursor: default;">獎號</th>'
														+ '      <th style="text-align: center; background-color: #A9A9A9; cursor: default;">開獎日</th>'
														+ '    </tr>'
														+ '  </thead>'
														+ '  <tbody class="rowlink"></tbody>'
														+ '</table>';
												modalBody = jQuery(tag);

												for (index = 1; index <= 49; index++) {

													vo = findLastAppeared(sprintf('%02d', index));

													if (vo !== null) {

														tag = '<tr>'
																+ '  <td style="text-align: center;">' + sprintf('%02d', index) + '</td>'
																+ '  <td style="text-align: center;">' + moment(vo.getDrawDate(), 'YYYYMMDD', true).format('YYYY/MM/DD') + '</td>'
																+ '</tr>';
														trElement = jQuery(tag);

														// if (_.indexOf(view.getArrCheckedNum(), sprintf('%02d', index)) != -1) trElement.find('td').addClass('bg-primary');
														if (_.indexOf(view.getArrCheckedNum(), sprintf('%02d', index)) != -1) trElement.find('td').css({"background-color": "#337AB7"});

														modalBody.find('tbody').append(trElement);
													}
												}

												baseModal = FormUtils.addBaseModal(modalHeader, modalBody, modalFooter);

												baseModal.find('tbody td').on('click', function(event) {
											
													if (StringUtils.rgb2hex(jQuery(event.target).css('background-color')) == '337AB7') {
												
														jQuery(event.target).parent().find('td').css({"background-color": "#FFFFFF"});
													}
													else {
												
														jQuery(event.target).parent().find('td').css({"background-color": "#337AB7"});
													}
												});
											
												baseModal.on('shown.bs.modal', function(event) {
											
													requirejs(["tablesort"], function() {
												
														new Tablesort(baseModal.find('table')[0]);
													});
												});

												baseModal.on('hidden.bs.modal', function(event) {
											
													var arrCheckedNum = new Array();
												
													baseModal.find('tbody tr').each(function(index, element) {
												
														if (StringUtils.rgb2hex(jQuery(element).find('td').first().css('background-color')) == '337AB7') arrCheckedNum.push(jQuery(element).find('td').first().text());
													});

													jQuery(this).remove();
												
													view.setArrCheckedNum(arrCheckedNum);
												});
			
												baseModal.modal('show');
											});
										}
									}
								]
							});
						});
					});
				});
			});
		</script>
  </body>
</html>